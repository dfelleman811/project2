<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excape - Escape Room Supplies</title>

    <link rel="icon" type="img/png" href="img/favicon.png">

    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <!-- FontAwesome CDN -->
    <script src="https://kit.fontawesome.com/91073f3496.js" crossorigin="anonymous"></script>

    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="style.css"/>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <mvc:cors>
		<mvc:mapping path="/**" />
	</mvc:cors>
</head>
<body>
<div class="container-fluid h-100">
    <!-- Header -->
    <nav class="navbar navbar-expand-md bg-light sticky-top py-2">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Excape</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse text-right" id="navbarResponsive">
                <ul class="navbar-nav ms-auto flex-nowrap">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Shop</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="login.html">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="register.html">Register</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cart.html">Cart</a>
                    </li>
                    <li class="nav-item d-flex">
                        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                        <button class="btn btn-outline-success" type="submit" onclick="search()">Search</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="text-center mt-5" style="padding-top:5%">
        <form style="max-width:480px; margin:auto;">
            <h1 class="mt-4 mb-3">Register</h1>
            <br>
            <div class="row">
                <div class="col">
                    <label for="firstname" class="sr-only">First Name</label>
                    <input type="text" id="firstname" class="form-control" placeholder="First Name" required autofocus>
                </div>
                <div class="col">
                    <label for="lastname" class="sr-only">Last Name</label>
                    <input type="text" id="lastname" class="form-control" placeholder="Last Name" required>
                </div>
            </div>
            <br>
                <label for="business" class="sr-only">Business Name</label>
                <input type="text" id="business" class="form-control" placeholder="Business Name (optional)">
            <br>
                <label for="address1" class="sr-only">Address</label>
                <input type="text" id="address1" class="form-control" placeholder="Street Address" required>          
            <br>
                <label for="address2" class="sr-only">Apartment, suite, unit, building, floor, etc. </label>
                <input type="text" id="address2" class="form-control" placeholder="Apartment, suite, unit, building, floor, etc." required>          
            <br>
            <div class="row">
                <div class="col">
                    <label for="city" class="sr-only">City</label>
                    <input type="text" id="city" class="form-control" placeholder="City" required>
                </div>
                <div class="col">
                    <label for="state" class="sr-only">State</label>
                    <select class="form-control" id="state" name="state" required>
                        <option value="" selected disabled>State</option>
                        <option value="AK">Alaska</option>
                        <option value="AL">Alabama</option>
                        <option value="AR">Arkansas</option>
                        <option value="AZ">Arizona</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DC">District of Columbia</option>
                        <option value="DE">Delaware</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="IA">Iowa</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MD">Maryland</option>
                        <option value="ME">Maine</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MO">Missouri</option>
                        <option value="MS">Mississippi</option>
                        <option value="MT">Montana</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="NE">Nebraska</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NV">Nevada</option>
                        <option value="NY">New York</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="PR">Puerto Rico</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VA">Virginia</option>
                        <option value="VT">Vermont</option>
                        <option value="WA">Washington</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WV">West Virginia</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>
                <div class="col">
                    <label for="zip" class="sr-only">Zip Code</label>
                    <input type="number" id="zip" class="form-control" placeholder="Zip Code" required>
                </div>
            </div>
            <br>
                <label for="email" class="sr-only">Email</label>
                <input type="email" id="email" class="form-control" placeholder="Email" required>
            <br>
                <label for="username" class="sr-only">Username</label>
                <input type="text" id="username" class="form-control" placeholder="Username" required>
            <br>
                <label for="password" class="sr-only">Password</label>
                <input type="password" id="password" class="form-control" placeholder="Password" required>
            <div class="d-grid gap-2 mt-3">
                <button class="btn btn-large btn-success" type="button" onclick="register()">Register</button>
            </div>
        </form>
        <br>
        <p>Already have an account? Log in <a href="login.html">here.</a></p>
    </div>


</div>


    <!-- Footer -->
    <footer></footer>

    <!-- Bootstrap JS -->
    
</body>

<script>
// Function to register user (persist to database) - collect input -> save to Object -> stringify -> send to server

    function register() {

        let fName = document.getElementById("firstname").value;
        let lName = document.getElementById("lastname").value;
        let bName = document.getElementById("business").value;
        let a1 = document.getElementById("address1").value;
        let a2 = document.getElementById('address2').value;
        let c = document.getElementById('city').value;
        let s = document.getElementById('state').value;
        let z = document.getElementById('zip').value;
        let e = document.getElementById('email').value;
        let uname = document.getElementById('username').value;
        let pword = document.getElementById('password').value;

        let newUser = {
            firstName : fName,
            lastName : lName,
            businessName : bName,
            email : e,
            address1 : a1,
            address2 : a2,
            city : c,
            state : s,
            zip : z,
            username : uname,
            password : pword
        }

        console.log(newUser);

        // AJAX Call
        let xhttp = new XMLHttpRequest();

        xhttp.open("POST", "http://localhost:8080/users", true);
        console.log(JSON.stringify(newUser));

        xhttp.setRequestHeader("Content-Type", "application/json");

        xhttp.send(JSON.stringify(newUser));
        

        xhttp.onreadystatechange = function() {

            if (this.readyState == 4 && this.status == 200) {
                console.log("Registered new user.")
                console.log(this.responseText);
                // modal? or pop up to let them know that they've succesfully registered?
            }
        }
    


    }

    function search() {

        // Collect input from search field
        let searchInput = document.getElementById("search").value;

        let xhttp = new XMLHttpRequest();

        xhttp.open("GET", `http://localhost:8080/items/search?name=${searchInput}`, true);

        xhttp.send();

        xhttp.onreadystatechange = function() {

            if (this.readyState == 4 && this.status == 200) {
                console.log(this.response);
            }
        }

    }
</script>
</html>